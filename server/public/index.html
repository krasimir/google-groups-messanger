<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VarnaLab Google group messanger</title>
  <link rel="stylesheet" href="/styles.css">
  <script>
    document.addEventListener('DOMContentLoaded', () => {

      function controlForm(enabled) {
        const form = document.querySelector('form');
        form.querySelector('input').disabled = !enabled;
        form.querySelector('textarea').disabled = !enabled;
        form.querySelector('button').disabled = !enabled;
      }

      // Handling the form submission
      const form = document.querySelector('form');
      const submitButton = document.querySelector('form button');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const subject = document.querySelector('#subject').value;
        const message = document.querySelector('#message').value;
        controlForm(false);
        submitButton.textContent = 'Sending...';
        const response = await fetch('/message', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ subject, message })
        });
        controlForm(true);
        submitButton.textContent = 'Send';
        if (!response.ok) {
          return alert('Message not sent');
        } else {
          alert('Message sent successfully');
        }
      });

      // Pre-filling the form
      const month = ['–Ø–Ω—É–∞—Ä–∏', '–§–µ–≤—Ä—É–∞—Ä–∏', '–ú–∞—Ä—Ç', '–ê–ø—Ä–∏–ª', '–ú–∞–π', '–Æ–Ω–∏', '–Æ–ª–∏', '–ê–≤–≥—É—Å—Ç', '–°–µ–ø—Ç–µ–º–≤—Ä–∏', '–û–∫—Ç–æ–º–≤—Ä–∏', '–ù–æ–µ–º–≤—Ä–∏', '–î–µ–∫–µ–º–≤—Ä–∏'][new Date().getMonth()].toLowerCase();
      const subject = `üëã –í–∞—Ä–Ω–∞–õ–∞–±: —á–µ—Å—Ç–∏—Ç –º–µ—Å–µ—Ü ${month}`;
      const message = `–ó–¥—Ä–∞–≤–µ–π—Ç–µ, –ª–∞–±—ä—Ä–∏! üéâüéâüéâ

–ú–µ—Å–µ—Ü ${month} –µ –≤–µ—á–µ —Ç—É–∫. –ö–∞–∫ —Å–∞ –Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏? –°–ø–æ–¥–µ–ª–µ—Ç–µ —Å –Ω–∞—Å —Ç—É–∫ –∏–ª–∏ –æ—â–µ –ø–æ-–¥–æ–±—Ä–µ –Ω–∞ –∂–∏–≤–æ –≤—ä–≤ –í–∞—Ä–Ω–∞–õ–∞–±. –ê–∫–æ –≤–∏ —Ö—Ä—É–º–≤–∞ –∏–¥–µ—è –∑–∞ —Å—ä–±–∏—Ç–∏–µ, –∏–ª–∏ –∏—Å–∫–∞—Ç–µ –¥–∞ –≤–∏–¥–∏—Ç–µ –∫–∞–∫–≤–æ –Ω–æ–≤–æ —Å–µ —Å–ª—É—á–≤–∞ –≤ –ª–∞–±–∞ - https://www.varnalab.org/bg/events.

–õ—é–±–µ–∑–Ω–æ –Ω–∞–ø–æ–º–Ω—è–º–µ, —á–µ –ª–∞–±–∞ —Å–µ –∏–∑–¥—ä—Ä–∂–∞ –æ—Ç –¥–∞—Ä–µ–Ω–∏—è –∏ —á–ª–µ–Ω—Å–∫–∏ –≤–Ω–æ—Å. –ê–∫–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –ø–æ–¥–∫—Ä–µ–ø–∏—Ç–µ –í–∞—Ä–Ω–∞–õ–∞–±, –º–æ–∂–µ—Ç–µ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ –¥–∞—Ä–µ–Ω–∏–µ —Ç—É–∫ - https://www.varnalab.org/bg/donate.

–ü–æ–∑–¥—Ä–∞–≤–∏,
–í–∞—Ä–Ω–∞–õ–∞–±
      `;
      document.querySelector('#subject').value = subject;
      document.querySelector('#message').value = message;
    });
  </script>
</head>
<body>
  <main>
    <section class="mx-auto max-800 px1">
      <h1 class="tac">VarnaLab Google group messanger</h1>
      <hr />
      <form>
        <div class="mb1">
          <label for="subject" class="block">Subject</label>
          <input type="text" id="subject" name="subject" required class="block">
        </div>
        <div class="mb1">
          <label for="message" class="block">Message</label>
          <textarea id="message" name="message" required class="block" rows='20'></textarea>
        </div>
        <div class="mb1">
          <button type="submit" class="block">Send</button>
        </div>
      </form>      
    </section>
  </main>
</body>
</html>